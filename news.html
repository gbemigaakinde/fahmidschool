<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Stay updated with the latest news and announcements from Fahmid Nursery & Primary School.">
    <title>News & Announcements - Fahmid Nursery & Primary School</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <!-- Firebase SDKs - Only load on pages that need it -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Skip to main content link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Hamburger Menu (Mobile) -->
    <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu" aria-expanded="false">
        <span class="line1"></span>
        <span class="line2"></span>
        <span class="line3"></span>
    </button>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar" aria-label="Main navigation">
        <div class="sidebar-header">
            <div class="logo-text">Fahmid School</div>
        </div>

        <div class="sidebar-content">
            <ul role="list">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="academics.html">Academics</a></li>
                <li><a href="admissions.html">Admissions</a></li>
                <li><a href="school-life.html">School Life</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="news.html" aria-current="page">News</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </div>

        <div class="sidebar-footer">
            <div class="sidebar-login-prompt">
                <a href="login.html" class="btn" style="width: 100%; padding: 15px; border-radius: 30px; font-size: 1.1rem; display: block; text-align: center;">
                    Login / Register
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
        <article class="container">
            <header>
                <h1>News & Announcements</h1>
            </header>

            <section aria-label="Announcements list">
                <div id="announcements-container" aria-live="polite">
                    <!-- Loading skeleton -->
                    <div class="skeleton-container">
                        <div class="skeleton" style="height: 40px; width: 60%; margin-bottom: 20px;"></div>
                        <div class="skeleton" style="height: 20px; width: 100%; margin-bottom: 10px;"></div>
                        <div class="skeleton" style="height: 20px; width: 90%; margin-bottom: 10px;"></div>
                        <div class="skeleton" style="height: 20px; width: 80%; margin-bottom: 30px;"></div>
                        
                        <div class="skeleton" style="height: 40px; width: 55%; margin-bottom: 20px;"></div>
                        <div class="skeleton" style="height: 20px; width: 100%; margin-bottom: 10px;"></div>
                        <div class="skeleton" style="height: 20px; width: 95%; margin-bottom: 10px;"></div>
                    </div>
                </div>
            </section>
        </article>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2026 Fahmid Nursery and Primary School. All rights reserved.</p>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

    <script src="script.js"></script>
    <script>
        /**
         * Firebase Configuration for News Page
         * Only loads announcements - no auth required
         */
        const firebaseConfig = {
            apiKey: "AIzaSyD0A1zJ9bGCwk_UioAbgsNWrV2M9C51aDo",
            authDomain: "fahmid-school.firebaseapp.com",
            projectId: "fahmid-school",
            storageBucket: "fahmid-school.firebasestorage.app",
            messagingSenderId: "48604608508",
            appId: "1:48604608508:web:5b387a2de260b9851a6479",
            measurementId: "G-HEC84JXFY2"
        };

        // Initialize Firebase for news page only
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        /**
         * Load and display announcements from Firestore
         * @async
         */
        async function loadAnnouncements() {
            const container = document.getElementById('announcements-container');
            
            try {
                const snapshot = await db.collection('announcements')
                    .orderBy('createdAt', 'desc')
                    .get();

                // Clear skeleton
                container.innerHTML = '';

                if (snapshot.empty) {
                    container.innerHTML = '<p style="text-align:center; color:var(--color-gray-600);">No announcements yet. Check back soon!</p>';
                    return;
                }

                snapshot.forEach(doc => {
                    const data = doc.data();
                    const article = document.createElement('article');
                    article.className = 'announcement-card';
                    article.style.cssText = 'background: var(--color-white); padding: var(--space-xl); border-radius: var(--radius-lg); box-shadow: var(--shadow-md); margin-bottom: var(--space-xl);';
                    
                    const title = document.createElement('h2');
                    title.textContent = data.title;
                    title.style.marginTop = '0';
                    
                    const content = document.createElement('p');
                    content.textContent = data.content;
                    
                    const date = document.createElement('small');
                    date.style.cssText = 'color: var(--color-gray-600); display: block; margin-top: var(--space-sm);';
                    date.textContent = `Posted: ${data.createdAt ? new Date(data.createdAt.toDate()).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : 'Just now'}`;
                    
                    article.appendChild(title);
                    article.appendChild(content);
                    article.appendChild(date);
                    container.appendChild(article);
                });
            } catch (error) {
                console.error('Error loading announcements:', error);
                container.innerHTML = '<p style="text-align:center; color:var(--color-danger);">Unable to load announcements. Please try again later.</p>';
            }
        }

        // Load announcements when page loads
        document.addEventListener('DOMContentLoaded', loadAnnouncements);
    </script>
</body>
</html>